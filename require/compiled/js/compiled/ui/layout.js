define(["require","exports","module","jquery","js/templates","js/events"],function(e,t,n){function a(e,t){var n=r(i.day(t)),s=n.find(".b-curriculum__lectures-list");_dayLectures[t.isoDate]=s,r.each(t.lectures,function(e,t){u.add(s,t,-1)}),e.append(n),o.emit.call(n,"new.day",t)}function f(e,t,n){n=n||"append";var s=r(i.week(t));r.each(t.days,function(e,t){a(s,t)}),e[n](s),o.emit.call(s,"new.week",t)}function l(e,t){r.each(t.weeks,function(t,n){f(e,n)}),o.emit.call(e,"init",t)}function p(e){i.ready.success(function(){if(!e.weeks.length)return;if(!h||!h["static"])e.on("clear",function(){_dayLectures=[],c.empty(),o.emit.call(c,"clear")}),e.on("init",function(){l(c,this)}),e.on("week.prepend",function(e){f(c,e,"prepend")}),e.on("week.append",function(e){f(c,e,"append")}),e.on("lecture.add",function(e,t,n){u.add(_dayLectures[t.isoDate],e,n)}),e.on("lecture.remove",function(e,t,n){u.remove(_dayLectures[t.isoDate],e,n)});l(c,e)})}var r=e("jquery"),i=e("js/templates"),s=e("js/events"),o=new s.Emitter,u={add:function(e,t,n){var s=r(i.lecture(t)),u=e.children();return n>=0&&n<u.length?r(u[n]).before(s):e.append(s),o.emit.call(s,"new.lecture",t),s},remove:function(e,t,n){var i=e.children();n>=0&&n<=i.length&&(r(i[n]).remove(),o.emit.call(e,"removed.lecture",t))}};_dayLectures={};var c=r(".b-curriculum"),h=n.config();t.init=p,t.on=o.on,t.off=o.off})